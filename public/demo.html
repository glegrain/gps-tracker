<!DOCTYPE html>
<html>
<head>
  <title>REST API Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/start/jquery-ui.css" type="text/css" rel="Stylesheet"/>
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
  <link rel="stylesheet" href="//cdn.leafletjs.com/leaflet-0.4/leaflet.css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
  <![endif]-->

  <style type="text/css">
  body {
    padding-top: 70px;
  }

  html, body, #map-canvas {
    margin: 0;
    padding: 0;
  }
  
  #map-canvas { 
    min-height: 600px;
    height: 100%;
    top: -20px;
  }

  </style>
</head>
<body>
<!-- Fixed navbar -->
    <header class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">API Documentation</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/">Home</a></li>
            <li><a href="/doc">Doc</a></li>
            <li class="active"><a href="/demo">Demo</a></li>
            <li class="dropdown">
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#about">Contact</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </header>

      <div class="loading"></div>
      <div id="infobox" class="infobox"></div>
      <div id="map-canvas">Loading map ...</div>


  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
  <script src="http://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
  <script src="//cdn.leafletjs.com/leaflet-0.7.2/leaflet.js?2"></script>

  <script type="text/javascript">


   var map;
   var marker;
  //  // load leaflet map
  //  map = L.map("map");
  // // leaflet API key tiler
  // L.tileLayer("http://{s}.tile.cloudmade.com/8c26b684aeec4950b9c2605b8fcc3293/997/256/{z}/{x}/{y}.png", { maxZoom: 18, detectRetina: true }).addTo(map);
  // // set map bounds
  // map.fitWorld();
  // //userMarker.addTo(map);
  // //userMarker.bindPopup("<p>You are there! Your ID is " + userId + "</p>").openPopup();

  function initialize() {
    var mapOptions = {
      zoom: 8,
      center: new google.maps.LatLng(45, 6)
    };
    map = new google.maps.Map(document.getElementById('map-canvas'),
        mapOptions);
    
    //var point = new google.maps.LatLng(latitude, longitude);
    // Place a marker
    marker  = new google.maps.Marker({
      //position: point,
      map: map
    });  

    map.setZoom(16);
   }

   
  // showing markers for connections
  function setMarker(data) {
    marker.setPosition( new google.maps.LatLng( data.latitude, data.longitude) );
    map.panTo( new google.maps.LatLng( data.latitude, data.longitude) );
    //map.setCenter(pt);
  }

  updatePosition = function() {
    var position;
    $.ajax({
      url: '/api/coordinates/1',
      type: 'GET',
      success: function(res) {
         console.log(res);
         setMarker(res);
         //longitude = res.longitude;
         //latitude = res.latitude;
      }
    });
  }

  google.maps.event.addDomListener(window, 'load', initialize);
  setInterval(updatePosition, 1000);
    // var map = L.map('map').setView([51.505, -0.09], 13);
    // L.tileLayer("http://{s}.tile.cloudmade.com/8c26b684aeec4950b9c2605b8fcc3293/997/256/{z}/{x}/{y}.png", { maxZoom: 18, detectRetina: true }).addTo(map);

  </script>
</body>
</html>
